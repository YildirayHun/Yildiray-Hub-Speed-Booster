local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer

local enabled = false
local SPEED = 30
local speedConn

local function getChar()
	local c = player.Character or player.CharacterAdded:Wait()
	local hrp = c:WaitForChild("HumanoidRootPart")
	local hum = c:FindFirstChildWhichIsA("Humanoid")
	return c, hrp, hum
end

local function getMoveDir()
	local _, _, hum = getChar()
	local move = hum.MoveDirection
	return move.Magnitude > 0.1 and move.Unit or Vector3.zero
end

local function startSpeed()
	if speedConn then return end
	speedConn = RunService.Heartbeat:Connect(function()
		local _, hrp, hum = getChar()
		if not hrp or not hum then return end
		local dir = getMoveDir()
		if dir.Magnitude > 0 then
			hrp.AssemblyLinearVelocity = Vector3.new(
				dir.X * SPEED,
				hrp.AssemblyLinearVelocity.Y,
				dir.Z * SPEED
			)
		end
	end)
end

local function stopSpeed()
	if speedConn then
		speedConn:Disconnect()
		speedConn = nil
	end
end

-- GUI OLUŞTURMA --
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "SillyBoosterGUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.IgnoreGuiInset = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.Parent = player:WaitForChild("PlayerGui")

local Main = Instance.new("Frame")
Main.Size = UDim2.new(0, 140, 0, 115) -- Boyut biraz artırıldı (E harfi için)
Main.Position = UDim2.new(1, -153, 0.29, 0)
Main.BackgroundColor3 = Color3.fromRGB(27, 42, 53)
Main.BorderSizePixel = 0
Main.Active = true
Main.Parent = ScreenGui

Instance.new("UICorner", Main).CornerRadius = UDim.new(0, 10)

local Stroke = Instance.new("UIStroke", Main)
Stroke.Thickness = 2
Stroke.Color = Color3.fromRGB(90, 170, 255)

local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, -10, 0, 26)
Title.Position = UDim2.new(0, 5, 0, 5)
Title.BackgroundTransparency = 1
Title.Text = "Yildiray Booster"
Title.TextColor3 = Color3.fromRGB(245, 205, 48)
Title.TextSize = 14
Title.Font = Enum.Font.GothamBold
Title.TextXAlignment = Enum.TextXAlignment.Center
Title.Parent = Main

-- E HARFİ ETİKETİ (YENİ EKLENDİ) --
local E_Label = Instance.new("TextLabel")
E_Label.Size = UDim2.new(0, 20, 0, 20)
E_Label.Position = UDim2.new(0, -10, 0, -10) -- Sol üst köşeye hafif taşacak şekilde
E_Label.BackgroundColor3 = Color3.fromRGB(27, 42, 53) -- Frame ile aynı renk
E_Label.BorderSizePixel = 0
E_Label.Text = "E"
E_Label.TextColor3 = Color3.fromRGB(245, 205, 48) -- Sarı renk
E_Label.TextSize = 16
E_Label.Font = Enum.Font.GothamBold
E_Label.Parent = Main

Instance.new("UICorner", E_Label).CornerRadius = UDim.new(0, 5)
local E_Stroke = Instance.new("UIStroke", E_Label)
E_Stroke.Thickness = 1.5
E_Stroke.Color = Color3.fromRGB(90, 170, 255)

local SpeedBox = Instance.new("TextBox")
SpeedBox.Size = UDim2.new(1, -24, 0, 26)
SpeedBox.Position = UDim2.new(0, 12, 0, 36)
SpeedBox.BackgroundColor3 = Color3.fromRGB(245, 205, 48)
SpeedBox.Text = "30"
SpeedBox.TextColor3 = Color3.fromRGB(255, 255, 255)
SpeedBox.TextSize = 14
SpeedBox.Font = Enum.Font.Gotham
SpeedBox.ClearTextOnFocus = false
SpeedBox.Parent = Main

Instance.new("UICorner", SpeedBox).CornerRadius = UDim.new(0, 6)
Instance.new("UIStroke", SpeedBox).Color = Color3.fromRGB(90, 170, 255)

SpeedBox:GetPropertyChangedSignal("Text"):Connect(function()
	local val = tonumber(SpeedBox.Text)
	if val then
		SPEED = val
	end
end)

local Toggle = Instance.new("Frame")
Toggle.Size = UDim2.new(0, 50, 0, 22)
Toggle.Position = UDim2.new(0.5, -25, 1, -30)
Toggle.BackgroundColor3 = Color3.fromRGB(27, 42, 53)
Toggle.Parent = Main

Instance.new("UICorner", Toggle).CornerRadius = UDim.new(1, 0)

local Knob = Instance.new("Frame")
Knob.Size = UDim2.new(0, 18, 0, 18)
Knob.Position = UDim2.new(0, 2, 0.5, -9)
Knob.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
Knob.Parent = Toggle

Instance.new("UICorner", Knob).CornerRadius = UDim.new(1, 0)

-- AÇ/KAPAT FONKSİYONU --
local function toggleSwitch()
	enabled = not enabled

	TweenService:Create(
		Knob,
		TweenInfo.new(0.2),
		{ Position = enabled and UDim2.new(1, -20, 0.5, -9) or UDim2.new(0, 2, 0.5, -9) }
	):Play()

	TweenService:Create(
		Toggle,
		TweenInfo.new(0.2),
		{ BackgroundColor3 = enabled and Color3.fromRGB(70, 140, 255) or Color3.fromRGB(70, 103, 164) }
	):Play()

	if enabled then
		startSpeed()
	else
		stopSpeed()
	end
end

Toggle.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1
	or input.UserInputType == Enum.UserInputType.Touch then
		toggleSwitch()
	end
end)

-- KLAVYE "E" TUŞU KONTROLÜ --
UserInputService.InputBegan:Connect(function(input, gameProcessed)
	if gameProcessed then return end 
	if input.KeyCode == Enum.KeyCode.E then
		toggleSwitch()
	end
end)

----------------------------------------------------------------
-- DRAG SYSTEM (Sürükleme Sistemi) --
----------------------------------------------------------------

local dragging
local dragInput
local dragStart
local startPos

local function update(input)
	local delta = input.Position - dragStart
	Main.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

Main.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		dragging = true
		dragStart = input.Position
		startPos = Main.Position

		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				dragging = false
			end
		end)
	end
end)

Main.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
		dragInput = input
	end
end)

UserInputService.InputChanged:Connect(function(input)
	if input == dragInput and dragging then
		update(input)
	end
end)
