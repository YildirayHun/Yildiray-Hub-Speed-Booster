local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer

-- AYARLAR --
local speedEnabled = false
local SPEED = 30
local speedConn

local infJumpEnabled = false
local jumpForce = 50
local clampFallSpeed = 80

-- YARDIMCI FONKSİYONLAR --
local function getChar()
	local c = player.Character or player.CharacterAdded:Wait()
	local hrp = c:WaitForChild("HumanoidRootPart")
	local hum = c:FindFirstChildWhichIsA("Humanoid")
	return c, hrp, hum
end

local function getMoveDir()
	local _, _, hum = getChar()
	local move = hum.MoveDirection
	return move.Magnitude > 0.1 and move.Unit or Vector3.zero
end

-- HIZ SİSTEMİ (SPEED) --
local function startSpeed()
	if speedConn then return end
	speedConn = RunService.Heartbeat:Connect(function()
		local _, hrp, hum = getChar()
		if not hrp or not hum then return end
		local dir = getMoveDir()
		if dir.Magnitude > 0 then
			hrp.AssemblyLinearVelocity = Vector3.new(
				dir.X * SPEED,
				hrp.AssemblyLinearVelocity.Y,
				dir.Z * SPEED
			)
		end
	end)
end

local function stopSpeed()
	if speedConn then
		speedConn:Disconnect()
		speedConn = nil
	end
end

-- ZIPLAMA SİSTEMİ (INF JUMP) --
RunService.Heartbeat:Connect(function()
    if not infJumpEnabled then return end
    local char, hrp = getChar()
    if hrp and hrp.Velocity.Y < -clampFallSpeed then
        hrp.Velocity = Vector3.new(hrp.Velocity.X, -clampFallSpeed, hrp.Velocity.Z)
    end
end)

UserInputService.JumpRequest:Connect(function()
    if not infJumpEnabled then return end
    local char, hrp = getChar()
    if hrp then
        hrp.Velocity = Vector3.new(hrp.Velocity.X, jumpForce, hrp.Velocity.Z)
    end
end)

-- GUI OLUŞTURMA --
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "YildirayHub"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = player:WaitForChild("PlayerGui")

local Main = Instance.new("Frame")
Main.Size = UDim2.new(0, 160, 0, 180) -- Boyut Inf Jump için uzatıldı
Main.Position = UDim2.new(1, -170, 0.3, 0)
Main.BackgroundColor3 = Color3.fromRGB(27, 42, 53)
Main.BorderSizePixel = 0
Main.Active = true
Main.Parent = ScreenGui

Instance.new("UICorner", Main).CornerRadius = UDim.new(0, 10)
local Stroke = Instance.new("UIStroke", Main)
Stroke.Thickness = 2
Stroke.Color = Color3.fromRGB(90, 170, 255)

local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0, 30)
Title.BackgroundTransparency = 1
Title.Text = "Yildiray Booster"
Title.TextColor3 = Color3.fromRGB(245, 205, 48)
Title.TextSize = 14
Title.Font = Enum.Font.GothamBold
Title.Parent = Main

-- HIZ KONTROLÜ (SPEED SECTION) --
local SpeedLabel = Instance.new("TextLabel")
SpeedLabel.Size = UDim2.new(1, 0, 0, 20)
SpeedLabel.Position = UDim2.new(0, 0, 0, 30)
SpeedLabel.BackgroundTransparency = 1
SpeedLabel.Text = "Hız (E Tuşu)"
SpeedLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
SpeedLabel.TextSize = 10
SpeedLabel.Font = Enum.Font.Gotham
SpeedLabel.Parent = Main

local SpeedBox = Instance.new("TextBox")
SpeedBox.Size = UDim2.new(0, 120, 0, 25)
SpeedBox.Position = UDim2.new(0.5, -60, 0, 50)
SpeedBox.BackgroundColor3 = Color3.fromRGB(40, 60, 80)
SpeedBox.Text = "30"
SpeedBox.TextColor3 = Color3.fromRGB(255, 255, 255)
SpeedBox.Font = Enum.Font.Gotham
SpeedBox.Parent = Main
Instance.new("UICorner", SpeedBox).CornerRadius = UDim.new(0, 5)

SpeedBox:GetPropertyChangedSignal("Text"):Connect(function()
	SPEED = tonumber(SpeedBox.Text) or 30
end)

local SpeedToggle = Instance.new("TextButton")
SpeedToggle.Size = UDim2.new(0, 120, 0, 25)
SpeedToggle.Position = UDim2.new(0.5, -60, 0, 80)
SpeedToggle.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
SpeedToggle.Text = "Speed: KAPALI"
SpeedToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
SpeedToggle.Font = Enum.Font.GothamBold
SpeedToggle.Parent = Main
Instance.new("UICorner", SpeedToggle).CornerRadius = UDim.new(0, 5)

-- INF JUMP KONTROLÜ (INF JUMP SECTION) --
local JumpLabel = Instance.new("TextLabel")
JumpLabel.Size = UDim2.new(1, 0, 0, 20)
JumpLabel.Position = UDim2.new(0, 0, 0, 110)
JumpLabel.BackgroundTransparency = 1
JumpLabel.Text = "Zıplama (F Tuşu)"
JumpLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
JumpLabel.TextSize = 10
JumpLabel.Font = Enum.Font.Gotham
JumpLabel.Parent = Main

local JumpToggle = Instance.new("TextButton")
JumpToggle.Size = UDim2.new(0, 120, 0, 25)
JumpToggle.Position = UDim2.new(0.5, -60, 0, 130)
JumpToggle.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
JumpToggle.Text = "Inf Jump: KAPALI"
JumpToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
JumpToggle.Font = Enum.Font.GothamBold
JumpToggle.Parent = Main
Instance.new("UICorner", JumpToggle).CornerRadius = UDim.new(0, 5)

--- FONKSİYONLARI TETİKLEME ---

local function toggleSpeed()
    speedEnabled = not speedEnabled
    SpeedToggle.Text = speedEnabled and "Speed: AÇIK" or "Speed: KAPALI"
    SpeedToggle.BackgroundColor3 = speedEnabled and Color3.fromRGB(50, 200, 50) or Color3.fromRGB(200, 50, 50)
    if speedEnabled then startSpeed() else stopSpeed() end
end

local function toggleJump()
    infJumpEnabled = not infJumpEnabled
    JumpToggle.Text = infJumpEnabled and "Inf Jump: AÇIK" or "Inf Jump: KAPALI"
    JumpToggle.BackgroundColor3 = infJumpEnabled and Color3.fromRGB(50, 200, 50) or Color3.fromRGB(200, 50, 50)
end

SpeedToggle.MouseButton1Click:Connect(toggleSpeed)
JumpToggle.MouseButton1Click:Connect(toggleJump)

-- KLAVYE TUŞLARI --
UserInputService.InputBegan:Connect(function(input, gpe)
    if gpe then return end
    if input.KeyCode == Enum.KeyCode.E then
        toggleSpeed()
    elseif input.KeyCode == Enum.KeyCode.F then
        toggleJump()
    end
end)

-- SÜRÜKLEME SİSTEMİ --
local dragging, dragInput, dragStart, startPos
Main.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		dragging = true
		dragStart = input.Position
		startPos = Main.Position
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then dragging = false end
		end)
	end
end)
UserInputService.InputChanged:Connect(function(input)
	if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
		local delta = input.Position - dragStart
		Main.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
	end
end)
